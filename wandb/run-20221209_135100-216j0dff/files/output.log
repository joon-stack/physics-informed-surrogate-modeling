Initializing MAML surrogate model
Current device:  cuda
hybrid_model(
  (module1): Sequential(
    (0): Linear(in_features=2, out_features=5, bias=True)
    (1): Linear(in_features=5, out_features=5, bias=True)
    (2): Linear(in_features=5, out_features=1, bias=True)
  )
)
Finished initialization of MAML-PINN model
Start MAML training at iteration 0
 20%|████████████████████████████████████▍                                                                                                                                                 | 1/5 [00:01<00:05,  1.30s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:02<00:00,  2.10it/s]
  0%|                                                                                                                                                                                           | 0/1000 [00:00<?, ?it/s]

  0%|▏                                                                                                                                                                                | 1/1000 [00:04<1:22:12,  4.94s/it]


  0%|▎                                                                                                                                                                                | 2/1000 [00:09<1:21:38,  4.91s/it]
  0%|▌                                                                                                                                                                                | 3/1000 [00:13<1:11:43,  4.32s/it]

  0%|▋                                                                                                                                                                                | 4/1000 [00:16<1:06:18,  3.99s/it]

  0%|▉                                                                                                                                                                                | 5/1000 [00:20<1:03:11,  3.81s/it]

  1%|█                                                                                                                                                                                | 6/1000 [00:24<1:01:53,  3.74s/it]

  1%|█▏                                                                                                                                                                               | 7/1000 [00:28<1:03:25,  3.83s/it]

  1%|█▍                                                                                                                                                                               | 8/1000 [00:32<1:08:56,  4.17s/it]


  1%|█▌                                                                                                                                                                               | 9/1000 [00:37<1:12:38,  4.40s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:03<00:00,  5.82it/s]
  1%|█▊                                                                                                                                                                              | 10/1000 [00:42<1:13:21,  4.45s/it]

  1%|█▉                                                                                                                                                                              | 11/1000 [00:45<1:08:24,  4.15s/it]
  1%|██                                                                                                                                                                              | 12/1000 [00:49<1:04:54,  3.94s/it]

  1%|██▎                                                                                                                                                                             | 13/1000 [00:52<1:02:26,  3.80s/it]

  1%|██▎                                                                                                                                                                             | 13/1000 [00:57<1:12:18,  4.40s/it]
Traceback (most recent call last):
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\run.py", line 94, in <module>
    maml.train(cfg.num_outer_steps, cfg.num_train_tasks, cfg.num_val_tasks)
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\maml.py", line 338, in train
    inner_loss, _ = self._outer_loop(train_tasks, train=True)
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\maml.py", line 218, in _outer_loop
    phi, grad, loss_sup, nrmse = self._inner_loop(theta, support, train)
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\maml.py", line 106, in _inner_loop
    x_train, t_train, y_train = generate_data(
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\data.py", line 64, in generate_data
    y = generate_y(x, t, num_x + 1, num_t + 1, alpha)
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\data.py", line 24, in generate_y
    y = burgers_viscous_time_exact1(alpha, xn, x, tn, t).T.reshape(-1, 1)
  File "C:\Users\fembem\Documents\GitHub\physics-informed-surrogate-modeling\burgers.py", line 144, in burgers_viscous_time_exact1
    vu[vxi,vti] = top / bot
KeyboardInterrupt